language: python
pythonVersion: '3.12'

# Use the updated startup script in the deployment directory
startupCommand: bash deployment/azure_startup.sh

# Azure App Service environment settings
environmentVariables:
  - name: DJANGO_ENV
    value: prod
  - name: DJANGO_SETTINGS_MODULE
    value: core.settings.prod
  - name: WEBSITE_HTTPLOGGING_RETENTION_DAYS
    value: 7
  - name: WEBSITE_LOG_CONTAINER_ENABLED
    value: 1
  - name: SCM_DO_BUILD_DURING_DEPLOYMENT
    value: 1
  - name: PYTHONPATH
    value: /home/site/wwwroot
  - name: WEBSITE_WEBDEPLOY_USE_SCM
    value: false

# Azure App Service deployment settings
appServicePlanTier: StandardS1
appServicePlanSize: S1
appServicePlanInstances: 1

# Azure App Service scaling settings
minReplicas: 1
maxReplicas: 3
targetCPUUtilizationPercentage: 70

# Azure App Service health check settings
healthCheckPath: /health/